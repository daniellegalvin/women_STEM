values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=data, aes(x=gender, y=number))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=data, aes(x=gender, y=number),
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=data, aes(x=position, y=number),
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data, aes(x=position, y=number),
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data, aes(x=position, y=number, color=gender),
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number, color=gender),
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number),
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number, size=0.7),
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number, size=0.4),
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number, size=1),
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number),
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number, size=0.5),
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number),
size=0.5,
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number),
size=0.7,
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number),
size=1,
position=position_dodge(width=0.9))+
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
# geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number),
#            size=1,
#            position=position_dodge(width=0.9))+    remove the silence to display the points
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
data <- read.csv("Data/WSTEM_data.csv")
head(data)
gender_data <- data %>%
mutate(gender=case_when(gender=="male" ~ "male",
gender=="unknown" ~ "unknown",
TRUE ~ "female")) %>%
mutate(position=case_when(position=="tt"~"tt",
TRUE ~ "instructor"))
?summarize
test$region
unique(test$region)
#Calculating the differences in female_tt by region
tt_diff <- test %>%
group_by(region, position) %>%
summarize(MW_SO=female-female)
View(tt_diff)
test %>%
group_by(region, position) %>%
summarize(MW_SO=female-female)
#Another data frame which I can use to calculate region and position specific values
specific <- test %>%
test
test <- mod_posts %>%
select(-.chain, -.iteration) %>%
distinct() %>%
pivot_wider(names_from = "gender", values_from = ".epred") %>%
mutate(diff = male - female)
mod_posts %>%
select(-.chain, -.iteration) %>%
distinct() %>%
pivot_wider(names_from = "gender", values_from = ".epred") %>%
mutate(diff = male - female)
#Another data frame which I can use to calculate region and position specific values
specific <- test %>%
pivot_wider(id_colss=c(region, .draw, diff),
names_from=position,
values_from=c("female", "male"))
#Another data frame which I can use to calculate region and position specific values
specific <- test %>%
pivot_wider(id_cols=c(region, .draw, diff),
names_from=position,
values_from=c("female", "male"))
View(specific)
#Another data frame which I can use to calculate region and position specific values
specific <- test %>%
pivot_wider(id_cols=c(region, .draw, diff),
names_from=position,
values_from=c("female", "male")) %>%
pivot_wider(id_cols=c(.draw, diff),
names_from=region,
values_from=c("female_tt", "male_tt", "female_instructor", "male_instructor"))
View(specific)
#Another data frame which I can use to calculate region and position specific values
specific <- test %>%
select(-diff) %>%
pivot_wider(id_cols=c(region, .draw, diff),
names_from=position,
values_from=c("female", "male")) %>%
pivot_wider(id_cols=c(.draw, diff),
names_from=region,
values_from=c("female_tt", "male_tt", "female_instructor", "male_instructor"))
#Another data frame which I can use to calculate region and position specific values
specific <- test %>%
select(-diff) %>%
pivot_wider(id_cols=c(region, .draw),
names_from=position,
values_from=c("female", "male")) %>%
pivot_wider(id_cols=c(.draw),
names_from=region,
values_from=c("female_tt", "male_tt", "female_instructor", "male_instructor"))
#Calculating the differences in female_tt by region
tt_diff <- specific %>%
mutate(MW_SO=female_tt_MW-female_tt_SO) %>%
mutate(MW_NE=female_tt_MW-female_tt_NE) %>%
mutate(MW_RM=female_tt_MW-female_tt_RM) %>%
mutate(MW_WC=female_tt_MW-female_tt_WC) %>%
mutate(MW_SW=female_tt_MW-female_tt_SW) %>%
mutate(MW_NW=female_tt_MW-female_tt_NW)
#Calculating the differences in female_tt by region
tt_diff <- specific %>%
mutate(MW_SO_tt=female_tt_MW-female_tt_SO) %>%
mutate(MW_NE_tt=female_tt_MW-female_tt_NE) %>%
mutate(MW_RM_tt=female_tt_MW-female_tt_RM) %>%
mutate(MW_WC_tt=female_tt_MW-female_tt_WC) %>%
mutate(MW_SW_tt=female_tt_MW-female_tt_SW) %>%
mutate(MW_NW_tt=female_tt_MW-female_tt_NW)
View(tt_diff)
View(tt_diff)
#Calculating the probability that the number of women in tt positions is greater in the midwest compared to the other region listed
tt_diff %>%
summarize(higher=sum(MW_SO_tt>0)/nrow(.))
tt_diff %>%
summarize(higher=sum(MW_NE_tt>0)/nrow(.))
tt_diff %>%
summarize(higher=sum(MW_RM_tt>0)/nrow(.))
tt_diff %>%
summarize(higher=sum(MW_WC_tt?0)/nrow(.))
tt_diff %>%
summarize(higher=sum(MW_WC_tt>0)/nrow(.))
#Calculating the differences in female_tt by region
tt_diff <- specific %>%
mutate(MW_SO_f_tt=female_tt_MW-female_tt_SO) %>%
mutate(MW_NE_f_tt=female_tt_MW-female_tt_NE) %>%
mutate(MW_RM_f_tt=female_tt_MW-female_tt_RM) %>%
mutate(MW_WC_f_tt=female_tt_MW-female_tt_WC) %>%
mutate(MW_SW_f_tt=female_tt_MW-female_tt_SW) %>%
mutate(MW_NW_f_tt=female_tt_MW-female_tt_NW)
#Calculating the probability that the number of women in tt positions is greater in the midwest compared to the other region listed
tt_diff %>%
summarize(higher=sum(MW_SO_f_tt>0)/nrow(.))
tt_diff %>%
summarize(higher=sum(MW_NE_f_tt>0)/nrow(.))
tt_diff %>%
summarize(higher=sum(MW_RM_f_tt>0)/nrow(.))
tt_diff %>%
summarize(higher=sum(MW_WC_f_tt>0)/nrow(.))
tt_diff %>%
summarize(higher=sum(MW_SW_f_tt>0)/nrow(.))
tt_diff %>%
summarize(higher=sum(MW_NW_f_tt>0)/nrow(.))
#Calculating the difference between men and women employed in tt positions by region
gender_tt_diff <- specific %>%
mutate(MW_gender_tt=male_tt_MW-female_tt_MW) %>%
mutate(SO_gender_tt=male_tt_SO-female_tt_SO) %>%
mutate(NE_gender_tt=male_tt_NE-female_tt_NE) %>%
mutate(RM_gender_tt=male_tt_RM-female_tt_RM) %>%
mutate(WC_gender_tt=male_tt_WC-female_tt_WC) %>%
mutate(SW_gender_tt=male_tt_SW-female_tt_SW) %>%
mutate(NW_gender_tt=male_tt_NW-female_tt_NW)
gender_tt_diff %>%
summarize(sum(MW_gender_tt>0/nrow(.)))
gender_tt_diff %>%
summarize(sum(MW_gender_tt>0)/nrow(.))
gender_tt_diff %>%
summarize(sum(MW_gender_tt>0)/nrow(.)) %>%
summarize(sum(SO_gender_tt>0)/nrow(.))
gender_tt_diff %>%
summarize(sum(SO_gender_tt>0)/nrow(.))
gender_tt_diff %>%
summarize(sum(NE_gender_tt>0)/nrow(.))
gender_tt_diff %>%
summarize(sum(RM_gender_tt>0)/nrow(.))
gender_tt_diff %>%
summarize(sum(WC_gender_tt>0)/nrow(.))
gender_tt_diff %>%
summarize(sum(SW_gender_tt>0)/nrow(.))
gender_tt_diff %>%
summarize(sum(NW_gender_tt>0)/nrow(.))
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
# geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number),
#            size=1,
#            position=position_dodge(width=0.9))+    remove the silence to display the points
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
graph_2 <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()
graph_2
graph_2 <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_y_log10()
graph_2
graph_2 <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_boxplot()+
scale_y_log10()
graph_2
graph_2 <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_boxplot()+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
graph_2
# scale_y_log10()+
# scale_y_log10()+
graph_2 <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_boxplot()+
# scale_y_log10()+
labs(x="Position", y="Number of people employed")
graph_2
gender_position
all_data <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_violin()+
scale_fill_manual(values=wes_palette("Darjeeling1"))+
# geom_point(data=gender_data %>% filter(gender==c("female", "male")), aes(x=position, y=number),
#            size=1,
#            position=position_dodge(width=0.9))+    remove the silence to display the points
facet_wrap(vars(region))+
scale_y_log10()+
labs(x="Position", y="Number of people employed")
all_data
gender_position <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=position, y=value, fill=gender))+
geom_boxplot()+
# scale_y_log10()+
labs(x="Position", y="Number of people employed")
gender_position
region_gender <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=region, y=value))+
geom_boxplot()
region_gender
region_gender <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=region, y=value, color=gender))+
geom_boxplot()
region_gender
region_gender <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=region, y=value, fill=gender))+
geom_boxplot()
region_gender
color_region <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=gender, y=value, fill=region))+
geom_boxplot()
color_region
color_region <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=gender, y=value, fill=region))+
geom_boxplot()+
scale_fill_manual(values=wes_palette("Darjeeling1"))
color_region
color_region <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=gender, y=value, fill=region))+
geom_boxplot()
color_region
color_region <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=gender, y=value, fill=region))+
geom_boxplot()+
facet_wrap(vars(position))
color_region
color_region <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=gender, y=value, fill=region))+
geom_violin()+
facet_wrap(vars(position))
color_region
color_region <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
ggplot(aes(x=gender, y=value, fill=region))+
geom_boxplot()+
facet_wrap(vars(position))
color_region
color_region <- test %>%
pivot_longer(cols=c("female", "male"),
names_to="gender",
values_to="value") %>%
filter(position==("tt")) %>%
ggplot(aes(x=gender, y=value, fill=region))+
geom_boxplot()
color_region
